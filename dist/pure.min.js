/*!
* Pure.js v1.0.0
* undefined
*
* Copyright (c) 2017 undefined
* Released under the MIT license
*
* Date: 2017-12-19T07:47:42.135Z
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Pure=e()}(this,function(){"use strict";function t(t){var e=(t=t||window.event).keyCode||t.which||t.charCode;return"string"==typeof e&&(e=function(t){return a[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)}(e)),e}function e(t,e){if(t){if("object"===(void 0===t?"undefined":c(t))){var n=Object.keys(t);0===n.length?e.call(t,0,t):n.forEach(function(n){e.call(t[n],n,t[n])})}else{if(!Array.isArray(t)&&!function(t){var e=Number.isNaN;return"number"==typeof t&&!e(t)}(t.length))throw new Error("each target not object ,array or array like");var i=void 0;for(i=0;i<t.length;i+=1)if(!1===e.call(t[i],i,t[i]))return t}return t}}function n(t,e){var n=t.className||"",i=n&&void 0!==n.baseVal;return void 0===e?i?n.baseVal:n:(i?n.baseVal=e:t.className=e,!1)}function i(t,i){i&&e(t,function(e,u){if("className"in u){var r=[],o=n(u);i.split(/\+s/g).forEach(function(t){(function(t,e){return!!e&&(t.classList?t.classList.contains(e):n(t).indexOf(e)>-1)})(u,t)||r.push(t)}),r.length&&n(t,o+(o?" ":"")+r.join(" "))}})}function u(t,i){e(t,function(e,u){if("className"in u)if(void 0!==i){var r=n(u);r.split(/\+s/g).forEach(function(t){r=r.replace(t,"")}),n(t,r)}else n(u,"")})}function r(t,e,n){(function(t){return"function"==typeof t})(n)&&(t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n)}window.document;var o={search:function(){}},a={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();return{Input:function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,e),this.element=t,this.option=Object.assign({},o,n),this.$input={},this.$result={},this.inputValue="",this.result=[],this.active=0,this.init()}return l(e,[{key:"init",value:function(){this.element.innerHTML='<input type="text" id="pure-input"><ul id="pure-input-result"></ul>',this.$input=document.querySelector("#pure-input"),this.$result=document.querySelector("#pure-input-result"),this.bind()}},{key:"bind",value:function(){var e=this,n=this.$input,o=this.$result,a=this.inputChange,c=this.option.chooseEvent;n.oninput=a.bind(this),n.onpropertychange=n.oninput,r(o,"mousedown",function(t){t=t||window.event,e.inputValue=t.target.innerText,n.value=e.inputValue,e.clearResultList(),c(e.inputValue)}),r(n,"focus",function(){e.inputFocus=!0}),r(n,"blur",function(){e.inputFocus=!1,function(){this.style.display="none"}.call(o)}),r(document,"keydown",function(n){if(e.inputFocus){(function(){this.style.display="block"}).call(o),n=n||window.event;var r=e.$input,a=t(n),s=e.result.length,l=document.querySelectorAll("#pure-input-result li");switch(a){case 38:if(n.preventDefault(),e.active<=1||0===s)return;e.active--,u(l[e.active],"active"),i(l[e.active-1],"active"),r.value=e.result[e.active-1];break;case 40:if(n.preventDefault(),e.active===s||0===s)return;e.active>0&&u(l[e.active-1],"active"),i(l[e.active],"active"),e.active++,r.value=e.result[e.active-1];break;case 13:if(0===e.active)return;r.value=e.result[e.active-1],e.clearResultList(),e.inputValue=r.value,c(e.inputValue);break;default:return}}})}},{key:"inputChange",value:function(){var t=this;this.active=0,this.inputValue=this.$input.value||"",this.getResult().then(function(e){t.result=e,console.log("inputchange search result",e),t.renderResultList()})}},{key:"clearResultList",value:function(){for(var t=this.$result;t.firstChild;)t.removeChild(t.firstChild);this.result=[],this.active=0}},{key:"renderResultList",value:function(){var t=this.$result,e=this.result;t.innerHTML=e.reduce(function(t,e){return t+"<li>"+e+"</li>"},""),this.active=0}},{key:"getResult",value:function(){var t=this.inputValue,e=this.option.search;return new Promise(function(n,i){try{n(e(t))}catch(t){i(t)}})}}]),e}()}});